function EditorCtrl(C,y,Wa,Xa){function n(a,c,b,e){this.id=a;this.image=c;this.tooltip=b;this.command=e}function Ya(a,c,b,e,f){var g=this;this.added=[];this.removed=[];this.updated=[];this.tag=f;this.name=a;this.background=c;this.diaLine=b;this.diaLineThickness=e;this.add=function(a){g.added.push(Utils.copyItem(a))};this.remove=function(a){g.removed.push(String(a))};this.update=function(a){g.updated.push(Utils.copyItem(a))};this.updateDiagram=function(a){qa(g,a)};this.persist=function(){g.change=
ra(g)}}function Za(){this.add=$a;this.persist=sa;this.remove=ab;this.update=bb;this.updateDiagram=cb}function P(a){this.name=a;this.different=!1;this.value=null}function $a(a){b.added.push(Utils.copyItem(a))}function D(a,c,b,e){var f=c();return Q(a,f,5,function(){var f=c();db(a,f,b,e)})}function Q(a,c,b,e){a=m(a,"div");a.style.display="inline-block";a.style.margin=b+"px";a.style.width="30px";a.style.height="30px";a.style.cursor="pointer";a.style.border="solid 1px #a0a0a0";a.style.borderRadius="5px";
ta(a,c);a.onclick=e;return a}function h(a,c,b,e){R[b+"-"+a.toString()+"-"+c.toString()]=e}function l(a,c,d){p("ec:addFree",[c]);var e=b.view,f=b.canvas,g=e.getZoom(),f=f.getBoundingClientRect().left+100*g;a=e.clientToDiagram(f,a.clientY);b.editor.insertFreeItem(a.x,a.y,c,d);b.view.redraw()}function eb(){var a=new n("f_rectangle","rectangle.png","BUT_FREE_RECTANGLE",function(a){l(a,"f_rectangle")}),c=new n("f_label","text.png","BUT_TEXT",function(a){l(a,"f_label")}),b=new n("f_line","line.png","BUT_LINE",
function(a){l(a,"f_line")}),e=new n("f_arrow","arrow.png","BUT_ARROW",function(a){l(a,"f_arrow")}),f=new n("f_begin","f_begin.png","BUT_FBEGIN",function(a){l(a,"f_begin")}),g=new n("f_rounded","rounded.png","BUT_ROUNDED",function(a){l(a,"f_rounded")}),h=new n("f_ptr_left","ptr-left.png","BUT_PTR_LEFT",function(a){l(a,"f_ptr_left")}),S=new n("f_ptr_right","ptr-right.png","BUT_PTR_RIGHT",function(a){l(a,"f_ptr_right")}),m=new n("f_insertion","f_insertion.png","BUT_INSERTION",function(a){l(a,"f_insertion")}),
p=new n("f_shelf","f_shelf.png","BUT_SHELF",function(a){l(a,"f_shelf")}),q=new n("f_callout","callout.png","BUT_CALLOUT",function(a){l(a,"callout")}),r=new n("f_circle","circle.png","BUT_CIRCLE",function(a){l(a,"f_circle")}),t=new n("f_ui_vscroll","f_ui_vscroll.png","BUT_UI_VSCROLL",function(a){l(a,"f_more","f_ui_vscroll")}),u=new n("f_ui_hscroll","f_ui_hscroll.png","BUT_UI_HSCROLL",function(a){l(a,"f_more","f_ui_hscroll")});k("free-basic",[a,c]);k("free-basic",[b,e]);k("free-basic",[f,g]);k("free-basic",
[h,S]);k("free-basic",[m,p]);k("free-basic",[q,r]);k("full",[a,c]);k("full",[b,e]);k("full",[h,S]);var v=new n("f_ui_cross","f_cross.png","BUT_UI_CROSS",function(a){l(a,"f_more","f_ui_cross")}),w=new n("f_ui_check","check.png","BUT_UI_CHECK",function(a){l(a,"f_more","f_ui_check")}),B=new n("f_ui_menu","f_menu.png","BUT_UI_MENU",function(a){l(a,"f_more","f_ui_menu")}),x=new n("f_ui_combo","f_combo.png","BUT_UI_COMBO",function(a){l(a,"f_more","f_ui_combo")}),y=new n("f_ui_left","left-angle.png","BUT_UI_LEFT",
function(a){l(a,"f_more","f_ui_left")}),z=new n("f_ui_right","right-angle.png","BUT_UI_RIGHT",function(a){l(a,"f_more","f_ui_right")}),ea=new n("f_ui_up","up-angle.png","BUT_UI_UP",function(a){l(a,"f_more","f_ui_up")}),A=new n("f_ui_down","down-angle.png","BUT_UI_DOWN",function(a){l(a,"f_more","f_ui_down")}),C=new n("f_ui_left2","left-angle2.png","BUT_UI_LEFT2",function(a){l(a,"f_more","f_ui_left2")}),E=new n("f_ui_right2","right-angle2.png","BUT_UI_RIGHT2",function(a){l(a,"f_more","f_ui_right2")}),
D=new n("f_ui_placeholder","placeholder.png","BUT_UI_PLACEHOLDER",function(a){l(a,"f_placeholder")}),F=new n("f_ui_tab","f_tab.png","BUT_UI_TAB",function(a){l(a,"f_tab")}),G=new n("f_ui_check_false","check_false.png","BUT_UI_CHECK_FALSE",function(a){l(a,"f_more","f_ui_check_false")}),H=new n("f_ui_check_true","check_true.png","BUT_UI_CHECK_TRUE",function(a){l(a,"f_more","f_ui_check_true")}),I=new n("f_ui_radio_false","radio_false.png","BUT_UI_RADIO_FALSE",function(a){l(a,"f_more","f_ui_radio_false")}),
J=new n("f_ui_radio_true","radio_true.png","BUT_UI_RADIO_TRUE",function(a){l(a,"f_more","f_ui_radio_true")}),K=new n("f_ui_dots3h","dots3h.png","BUT_UI_DOTS3H",function(a){l(a,"f_more","f_ui_dots3h")}),L=new n("f_ui_dots3v","dots3v.png","BUT_UI_DOTS3V",function(a){l(a,"f_more","f_ui_dots3v")}),M=new n("f_ui_close","close.png","BUT_UI_CLOSE",function(a){l(a,"f_more","f_ui_close")}),N=new n("f_ui_close_mac","close_mac.png","BUT_UI_CLOSE_MAC",function(a){l(a,"f_more","f_ui_close_mac")}),O=new n("f_ui_search",
"search.png","BUT_UI_SEARCH",function(a){l(a,"f_more","f_ui_search")});k("free-ui",[a,c]);k("free-ui",[b,e]);k("free-ui",[f,g]);k("free-ui",[h,S]);k("free-ui",[q,p]);k("free-ui",[r,D]);k("free-ui",[u,t]);k("free-ui",[H,G]);k("free-ui",[J,I]);k("free-ui",[v,w]);k("free-ui",[B,x]);k("free-ui",[y,z]);k("free-ui",[ea,A]);k("free-ui",[C,E]);k("free-ui",[F,O]);k("free-ui",[M,N]);k("free-ui",[K,L]);t=new n("f_ar_pc","pc.png","BUT_AR_PC",function(a){l(a,"f_more","f_ar_pc")});u=new n("f_ar_human","human.png",
"BUT_AR_HUMAN",function(a){l(a,"f_more","f_ar_human")});v=new n("f_ar_server1","server1.png","BUT_AR_SERVER1",function(a){l(a,"f_more","f_ar_server1")});w=new n("f_ar_server2","server2.png","BUT_AR_SERVER2",function(a){l(a,"f_more","f_ar_server2")});B=new n("f_ar_phone","phone.png","BUT_AR_PHONE",function(a){l(a,"f_more","f_ar_phone")});x=new n("f_ar_tablet","tablet.png","BUT_AR_TABLET",function(a){l(a,"f_more","f_ar_tablet")});y=new n("f_ar_notebook","notebook.png","BUT_AR_NOTEBOOK",function(a){l(a,
"f_more","f_ar_notebook")});z=new n("f_ar_portrait","portrait.png","BUT_AR_PORTRAIT",function(a){l(a,"f_more","f_ar_portrait")});ea=new n("f_cloud","cloud.png","BUT_AR_CLOUD",function(a){l(a,"f_cloud","")});A=new n("f_db","db.png","BUT_AR_DATABASE",function(a){l(a,"f_db","")});k("free-ar",[a,c]);k("free-ar",[b,e]);k("free-ar",[f,g]);k("free-ar",[h,S]);k("free-ar",[m,p]);k("free-ar",[q,r]);k("free-ar",[ea,A]);k("free-ar",[u,z]);k("free-ar",[t,y]);k("free-ar",[v,w]);k("free-ar",[B,x])}function fb(){var a=
{id:"mind_horver",image:"horver.png",tooltip:"MES_TOGGLE_TREE",command:gb},c=new n("f_callout","callout.png","BUT_CALLOUT",function(a){l(a,"callout")});new n("f_circle","circle.png","BUT_CIRCLE",function(a){l(a,"f_circle")});var b=new n("f_line","line.png","BUT_LINE",function(a){l(a,"f_line")}),e=new n("f_arrow","arrow.png","BUT_ARROW",function(a){l(a,"f_arrow")}),f=new n("f_ptr_left","ptr-left.png","BUT_PTR_LEFT",function(a){l(a,"f_ptr_left")}),g=new n("f_ptr_right","ptr-right.png","BUT_PTR_RIGHT",
function(a){l(a,"f_ptr_right")}),h=new n("f_rectangle","rectangle.png","BUT_FREE_RECTANGLE",function(a){l(a,"f_rectangle")});k("dia-mind",[{id:"mind_action",image:"rectangle.png",tooltip:"BUT_RECTANGLE",shortcut:"A",command:function(){F("action")}},{id:"mind_raction",image:"rounded.png",tooltip:"BUT_ROUNDED",shortcut:"R",command:function(){F("raction")}}]);k("dia-mind",[{id:"mind_collection",image:"collection.png",tooltip:"BUT_COLLECTION",shortcut:"C",command:function(){F("collection")}},{id:"mind_beginend",
image:"f_begin.png",tooltip:"BUT_FBEGIN",shortcut:"S",command:function(){F("beginend")}}]);k("dia-mind",[{id:"mind_insertion",image:"insertion.png",tooltip:"BUT_INSERTION",shortcut:"N",command:function(){F("insertion")}},{id:"tt_shelf",image:"shelf.png",shortcut:"F",tooltip:"BUT_SHELF",command:function(){q("shelf")}}]);k("dia-mind",[a]);k("dia-mind2",[b,e]);k("dia-mind2",[f,g]);k("dia-mind2",[h,c])}function G(a,c,d){d=b.translate(d);a=m(a,"option");HtmlUtils.setDivText(a,d);a.value=c}function k(a,
c){H(a).rows.push(c)}function K(a,c){var b=m(a,"table");b.className="toolbox";for(var e=0,f=c.rows,g=f.length;e<g;){var h=f[e],k=m(b,"tr");hb(k,h);e++}}function p(a,c){CallTrace.add(a,c)}function ra(a){var c={editType:"edit",name:a.name,background:a.background,diaLine:a.diaLine,diaLineThickness:a.diaLineThickness,font:a.font,added:a.added,removed:a.removed,updated:a.updated};ua(a,c);return c}function va(a){var c={name:a.name,type:a.type,background:a.background,diaLine:a.diaLine,diaLineThickness:a.diaLineThickness,
version:a.version,font:a.font,nodes:{},edges:{},free:{}},b=0;a=a.items;for(var e=a.length;b<e;){var f=Utils.copyItem(a[b]),g=f.id;f.free?c.free[g]=f:f.isLine?c.edges[g]=f:c.nodes[g]=f;b++}return c}function ib(a){var c=Theme.build(a);return{image:c.image,callback:function(){Theme.current=c;b.saveUserSettings({theme:c});b.editor.redraw();b.view.rebuild()}}}function jb(a,c){fa();ga("MES_BACKGROUND");var d=x("MES_FILL"),d=m(d,"div"),d=D(d,function(){return b.background||Theme.getBackground()},"MES_BACKGROUND_COLOR",
kb);b.dialogs.backColorButt=d;d.style.cursor="pointer";if(wa()||"mind"==b.type){var d=x("MES_LINE"),d=m(d,"div"),e=D(d,function(){return b.diaLine||Theme.getLine()},"MES_LINE_COLOR",lb);b.dialogs.diaLineColorButt=e;e.style.cursor="pointer";e.style.verticalAlign="bottom";I(d,"thickness.png",40,30,function(a){xa(a,1,b.diaLineThickness||1,mb)},!1)}d=x(null);L(d,"MES_CLEAR_BACKGROUND",nb);L(d,"MES_SET_DEFAULT_BACK",ob);L(d,"MES_CLEAR_DEFAULT_BACK",pb);ha(a,c)}function qb(a,c,d){var e=b.dialogs;fa();ga("MES_FORMAT");
var f=b.editor.getFormat(d),g=b.editor.getFontsForItems(d);rb(f,g);e.ids=d;var h;h=f.hasLine?1:0;if(!f.lineOnly){var g=x("MES_FILL"),g=m(g,"div"),k=D(g,function(){return e.fillColor0||Theme.getIconBack("action")},"MES_FILL_COLOR",ya);k.style.verticalAlign="bottom";k.style.margin="0px";k.style.marginRight="5px";e.fillColorButt=k;g.style.padding="5px";za(g,"MES_GRADIENT","gradient"==e.fillType,sb);za(g,"MES_SHADOW",!!e.shadow,tb).style.marginLeft="10px";e.allowSecondary&&(g=x("MES_SECONDARY"),g=m(g,
"div"),g.style.padding="5px",g=D(g,function(){return e.secondaryColor||Theme.getCommentBack()},"MES_SECONDARY",ub),g.style.verticalAlign="bottom",g.style.margin="0px",g.style.marginRight="5px",e.secondaryColorButt=g)}var g=x("MES_TEXT"),k=m(g,"div"),l=D(k,function(){return e.textColor||Theme.getIconFont("action")},"MES_TEXT_COLOR",vb);e.textColorButt=l;l.style.verticalAlign="bottom";e.boldButt=M(k,"bold.png",wb);e.italicButt=M(k,"italics.png",xb);e.alignLeftButt=M(k,"align-left.png",function(){ia("left")});
e.alignCenterButt=M(k,"align-center.png",function(){ia("center")});e.alignRightButt=M(k,"align-right.png",function(){ia("right")});e.alignLeftButt.div.style.marginLeft="5px";e.alignLeftButt.div.style.borderRadius="5px 0px 0px 5px";k=e.alignCenterButt.div.style;k.borderRadius="0px";k.borderLeft="";k.borderRight="";e.alignRightButt.div.style.borderRadius="0px 5px 5px 0px";e.italicButt.div.style.borderRadius="0px 5px 5px 0px";e.boldButt.div.style.borderRadius="5px 0px 0px 5px";e.boldButt.div.style.borderRight=
"";r(e.boldButt,e.bold);r(e.italicButt,e.italic);e.align&&Aa(e.align);k=m(g,"div");k.style.paddingRight="5px";l=yb(e.family);Ba(k,"MES_FONT_FAMILY",150,l,zb);Ba(k,"MES_FONT_SIZE",50,Ab(e.size),Bb);g=m(g,"div");T(g,"MES_SET_DEFAULT_FONT",Cb);g=x("MES_LINE");g=m(g,"div");k=D(g,function(){return e.lineColor||Theme.getIconFont("action")},"MES_LINE_COLOR",Db);k.style.verticalAlign="bottom";e.lineColorButt=k;I(g,"thickness.png",40,30,function(a){xa(a,h,e.lineThickness,Eb)},!1);I(g,"style.png",40,30,Fb,
!1).div.style.marginLeft="5px";f.lineOnly?(I(g,"arrow-left.png",40,30,Gb,!1).div.style.marginLeft="5px",I(g,"arrow-right.png",40,30,Hb,!1).div.style.marginLeft="5px"):(f=x(""),f.style.paddingTop="10px",T(f,"MES_CLEAR_FORMAT",Ib),T(f,"MES_SET_DEFAULT_STYLE",Jb),T(f,"MES_CLEAR_DEFAULT_STYLE",Kb));1==d.length&&(a=b.editor.getItemRect(d[0]),c=Ca(a.right,a.top),a=c.x+30,c=c.y);ha(a,c)}function Lb(){C.location.href="/account?page=language&ref=diagram"}function Mb(a){return b.readonly?b.translate("ERR_READONLY"):
a&&a.length>Config.MAX_TEXT?b.translate("ERR_TEXT_TOO_LONG"):null}function Nb(){return b.readonly?b.translate("ERR_READONLY"):null}function Ob(a,c,b,e,f){if("italic"===a)a=c;else if("bold"===a)a=b;else if("size"===a)a=e;else{if("family"!==a)throw"Unexpected switch value: "+a;a=f}return a}function nb(){p("ec:clearBackground");b.userBackground="";b.userDiaLine="";b.userDiaLineThickness="";b.editor.setBackground({diaLineThickness:"",diaLine:"",background:""});b.view.redraw()}function pb(){Da("","","")}
function Kb(){b.saveUserSettings({shape:""});b.userShape="";w()}function Ib(){p("ec:clearFormat");var a=Config.FONT_FAMILY;b.loadFont(!1,!1,a,R[a+"-"+(!1).toString()+"-"+(!1).toString()],Pb)}function Qb(){Ea("")}function Rb(){}function Sb(a,c){b.clipboard.copyToClipboard(a,c)}function Fa(a,c,b){a=m(a,"div");a.style.background="#fcfcfc";a.style.display="inline-block";a.style.verticalAlign="bottom";a.style.cursor="pointer";a.style.border="solid 1px #a0a0a0";a.style.borderRadius="5px";a.style.marginBottom=
"5px";var e={isToggle:b,on:!1,down:!1,div:a,idle:"#fcfcfc",active:"#a0a0a0",onClick:c};c=function(){e.down=!1;e.isToggle&&e.on||(e.div.style.background=e.idle)};HtmlUtils.registerDown(a,function(){e.down=!0;e.div.style.background=e.active});HtmlUtils.registerMove(a,function(){});HtmlUtils.registerUp(a,function(){e.down&&(e.down=!1,e.isToggle?(e.div.style.background=e.on?e.idle:e.active,r(e,!e.on)):e.div.style.background=e.idle,e.onClick(e))});a.onmouseleave=c;a.ontouchcancel=c;a.oncontextmenu=function(){return!1};
return e}function Ba(a,c,d,e,f){a=Fa(a,Tb,!1);a.title=c;a.items=e;a.onSelected=f;c=a.div;e=m(c,"div");e.style.display="inline-block";e.style.overflowX="hidden";e.style.width=d+"px";e.style.whiteSpace="nowrap";a.label=e;c.style.marginLeft="5px";c.style.paddingRight="5px";e.style.paddingLeft="5px";e.style.paddingBottom="5px";Ga(a);d=m(c,"img");d.width=13;d.height=30;d.src=b.imageBase+"tri-down.png";d.verticalAlign="middle";return a}function T(a,c,d){a=m(a,"div");a.className="panic_button";a.style.margin=
"5px";a.style.marginTop="0px";HtmlUtils.setDivText(a,b.translate(c));a.style.fontSize="80%";a.onclick=d;return a}function M(a,c,b){return I(a,c,30,30,b,!0)}function B(a,c){b.groups.push({name:a,type:c,rows:[]})}function I(a,c,d,e,f,g){a=Fa(a,f,g);f=a.div;g=m(f,"img");g.width=d;g.height=e;g.src=b.imageBase+c;g.verticalAlign="middle";f.style.width=d+"px";f.style.height=e+"px";return a}function Ha(a,c,d,e){var f=b.leftButts.length;a={command:a,side:"left",direction:c,background:d,image:e||null};a={div:Ia(a),
visible:!0,button:a};b.leftButts.push(a);return f}function Ja(){var a=HtmlUtils.createPopup(null);return b.dialogs.popup=a}function Ia(a){var c=0,d=m(b.root,"img");d.width=40;d.height=40;d.src=Ka(a,a.direction);var e=d.style;e.background=a.background;e.borderBottom="solid 1px #b0b0b0";e.borderTop="solid 1px #b0b0b0";e.cursor="pointer";d.onclick=a.command;c=a.side;if("left"===c)e.borderBottomRightRadius="7px",e.borderTopRightRadius="7px",e.borderRight="solid 1px #b0b0b0";else{if("right"!==c)throw"Unexpected switch value: "+
c;e.borderBottomLeftRadius="7px";e.borderTopLeftRadius="7px";e.borderLeft="solid 1px #b0b0b0"}return d}function L(a,c,d){a=m(a,"div");c=b.translate(c);a=m(a,"div");HtmlUtils.setDivText(a,c);a.className="panic_button";a.onclick=function(){d();w()};return a}function ga(a){a=b.translate(a);var c=m(b.dialogs.dialog,"div");c.style.background="#455A64";c=m(c,"table");c.style.width="280px";c.style.color="white";var d=m(c,"tr"),c=m(d,"td");c.width="250";c.style.paddingLeft="5px";c.style.cursor="default";
d=m(d,"td");d.width="30";d.onclick=w;d.ontouchstart=w;d=m(d,"img");d.className="common_button";d.src=b.imageBase+"cross.png";d.width="30";d.height="30";d.verticalAlign="middle";d.style.cursor="pointer";HtmlUtils.setDivText(c,a)}function x(a){var c=m(b.dialogs.dialog,"div");c.style.background="white";c.style.borderTop="solid 1px #455A64";if(a){var d=m(c,"div");a=b.translate(a);HtmlUtils.setDivText(d,a);d.style.background="#E2EDF5";d.style.padding="5px"}return c}function fa(){var a=b.dialogs;a.dialog=
HtmlUtils.createPopup(b.beh.externalClick);ja(a.dialog)}function Ca(a,c){var d=HtmlUtils.rect(b.canvas),e=b.view.diagramToClient(a,c);e.x=Math.round(e.x+d.left);e.y=Math.round(e.y+d.top);return e}function Ub(a,c,d,e){var f=b.dialogs;fa();ga("MES_EXTERNAL_LINK");var g=x(null);f.itemId=a;f.content=c;a=m(g,"textarea");a.id="link_text";a.style.boxSizing="border-box";a.style.resize="none";a.style.outline="none";a.style.width="260px";a.style.padding="5px";a.style.height="70px";a.style.margin="10px";a.style.border=
"solid 1px #707070";a.style.fontSize="12pt";a.style.fontFamily=Config.FONT_FAMILY;a.style.verticalAlign="top";a.autocorrect="off";a.autocapitalize="off";a.spellcheck="false";f=m(g,"div");f.id="link_message";f.style.color="red";f.style.padding="10px";c.link&&(a.value=c.link);L(g,"MES_CLEAR",Qb);L(g,"MES_SAVE",Vb).style.background="coral";c=e;e=Math.round(c+287-C.innerHeight/2);ha(d-100,0<e?c-e:c);a.select();a.focus()}function Wb(a,c){for(var d=b.dialogs.faces,e=Utils.listToSet(d),f=[],g=0,h=d.length;g<
h;){var k=Utils.parseFontFace(d[g]);k[a]=c;k=Utils.buildFontFace(k.italic,k.bold,k.family);k in e||f.push(k);g++}return f}function H(a){for(var c=0,d=b.groups,e=d.length;;){if(!(c<e))throw Error("Group '"+a+"' not found");var f=d[c];if(f.name==a)return f;c++}}function Pb(){b.editor.clearFormat(b.dialogs.ids);b.view.redraw();w()}function N(){var a=b.toolbar;a.innerHTML="";var c=H("dia-main");K(a,c);c=m(a,"div");c.id="dia-icons";t(c.id);var d=b.toolName,e=m(c,"select");e.style.width="93px";e.style.fontSize=
"80%";e.style.height="30px";G(e,"basic","MES_BASIC");G(e,"medic","MES_MEDIC");G(e,"full","MES_FULL");e.value=d;e.onchange=Xb;d=H(d);K(c,d);c=m(a,"div");c.id="dia-free";t(c.id);d=b.toolNameFree;e=m(c,"select");e.style.width="93px";e.style.fontSize="80%";e.style.height="30px";G(e,"free-basic","MES_BASIC");G(e,"free-ui","UI");G(e,"free-ar","MES_ARCHITECTURE");e.value=d;e.onchange=Yb;d=H(d);K(c,d);a=m(a,"div");a.id="dia-mind";t(a.id);c=H(b.toolNameMind);K(a,c);c=H("dia-mind2");K(a,c)}function ka(a,c){var b=
{};b["font-"+a]=c;u(b)}function Zb(a){if(a=(a||"").trim())-1==a.indexOf("://")&&(a="http://"+a),C.open(a,"_blank")}function la(a){var c=y.getElementById(a);if(c)return c;throw Error("Element '"+a+"' not found");}function La(){var a=b.cnv.getBackground();return a=a||Theme.getBackground()}function $b(){return b.clipboard.getClipboard()}function ac(){return b.clipboard.getClipboardType()}function Ma(){var a=b.dialogs,c=a.fillColor0||"#ffffff";if("gradient"==a.fillType){var a=c.slice(1,3),d=c.slice(3,
5),e=c.slice(5,7),a=parseInt("0x"+a)/255,d=parseInt("0x"+d)/255,e=parseInt("0x"+e)/255,a=Math.floor(255*ma(a)),d=Math.floor(255*ma(d)),e=Math.floor(255*ma(e));return"gradient "+("#"+a.toString(16)+d.toString(16)+e.toString(16))+" "+c}return c}function bc(a){return"background"===a?b.userBackground:"diaLine"===a?b.userDiaLine:"diaLineThickness"===a?b.userDiaLineThickness:"font"===a?b.userFont:"shape"===a?b.userShape:null}function Na(a){a=na(a)||a;a=b.editor.getFonts(a);var c=b.userFont;c&&(a.push(c),
c=Utils.parseFontString(c),c=Utils.buildFontString(c.italic,!0,c.size,c.family),a.push(c));for(var c={},d=0,e=a.length;d<e;){var f=Utils.parseFontString(a[d]),g=f.italic.toString()+"-"+f.bold.toString()+"-"+f.family;f.file=R[f.family+"-"+f.italic.toString()+"-"+f.bold.toString()];c[g]=f;d++}return Utils.objectValues(c)}function Ka(a,c){var d;if("left"===c)d="hide-left.png";else{if("right"!==c)throw"Unexpected switch value: "+c;d=a.image?a.image:"show-right.png"}return b.imageBase+d}function U(a,c){c[a.name]=
null==a.value||a.different?null:a.value}function t(a){V(a,"none")}function w(){HtmlUtils.hidePopup();b.dialogs.dialog=null;HtmlUtils.hidePopup()}function z(a){a.style.display="none"}function W(){b.dialogs.popup=null;HtmlUtils.hidePopup()}function J(){var a=b.editor.measureDiagram(),c=b.view.getZoom();b.view.pan(-a.left+Math.floor(45/c),-a.top+Math.floor(5/c))}function ua(a,c){var b;b=Math.random();b=Math.floor(1E9*b).toString();c.tag=b;c.oldTag=a.tag;a.tag=b}function cc(a,c,d,e,f){e=Ca(e,f);b.inputBox.show(a,
c,function(a){d(a);b.view.redraw()},Mb,e.x,e.y)}function wa(){return"drakon"==b.type}function X(){var a=b.box.left,c=b.box.top,d=b.box.width,e=b.box.height;b.primed||(b.primed=!0,b.showToolbar=500<d);Oa();E(b.root,a,c,d,e);var f;if(b.freeScroll){var c=0,g=b.rightButts;for(f=g.length;c<f;)a=g[c],z(a.div),c++;c=0;g=b.leftButts;for(f=g.length;c<f;)a=g[c],z(a.div),c++}else{f=b.showToolbar?115:0;for(var c=b.box.width-40,h=g=0,k=b.leftButts,m=k.length;h<m;)a=k[h],a.visible?(E(a.div,f,g,40,40),g+=40):z(a.div),
h++;f=g=0;h=b.rightButts;for(k=h.length;f<k;)a=h[f],a.visible?(E(a.div,c,g,40,40),g+=40):z(a.div),f++}b.freeScroll?(b.back.style.display="inline-block",z(b.toolbar),E(b.canvas,0,0,d,e)):(z(b.back),b.showToolbar?(E(b.toolbar,0,0,115,e),E(b.canvas,116,0,d-115-1,e),oa(b.over,116,0,d-115-1,e)):(z(b.toolbar),E(b.canvas,0,0,d,e),oa(b.over,0,0,d,e)))}function ma(a){return Math.min(1,a+(.4>a?.5:.3))}function Pa(a){var c=Utils.parseFontFace(a.faces[a.current]);b.loadFont(c.italic,c.bold,c.family,R[c.family+
"-"+c.italic.toString()+"-"+c.bold.toString()],function(){a.fontLoaded()})}function m(a,c){var b=y.createElement(c);a.appendChild(b);"img"==c&&(b.draggable=!1);return b}function za(a,c,d,e){a=m(a,"label");var f=m(a,"input");f.type="checkbox";f.style.marginRight="5px";f.onchange=e;f.checked=d;c=b.translate(c);c=y.createTextNode(c);a.appendChild(c);return a}function Qa(a){return function(){var c=b.dialogs.currentColor;Utils.isColor(c)&&(W(),Ra(c),a(c))}}function dc(a,c){return function(){W();Ra(c);
a(c)}}function ec(a,c){return function(){W();a(c)}}function fc(a){var c=a.style;a.onmousemove=function(){c.background="#E2EDF5"};a.onmouseleave=function(){c.background="#ffffff"}}function yb(a){for(var c=[{text:"PT Mono",value:"PT Mono"},{text:"Fira Code",value:"Fira Code"},{text:"Courier (Cousine)",value:"Cousine"},{text:"Times (Tinos)",value:"Tinos"},{text:"Alegreya Sans",value:"Alegreya Sans"},{text:"Anonymous Pro",value:"Anonymous Pro"},{text:"Cormorant Garamond",value:"Cormorant Garamond"},{text:"Lato",
value:"Lato"},{text:"Arial (Liberation Sans)",value:"Liberation Sans"},{text:"Lora",value:"Lora"},{text:"Merriweather",value:"Merriweather"},{text:"Noto Sans",value:"Noto Sans"},{text:"Open Sans",value:"Open Sans"},{text:"PT Sans",value:"PT Sans"},{text:"PT Serif",value:"PT Serif"},{text:"Raleway",value:"Raleway"},{text:"Roboto",value:"Roboto"},{text:"Roboto Condensed",value:"Roboto Condensed"},{text:"Roboto Mono",value:"Roboto Mono"},{text:"Source Code Pro",value:"Source Code Pro"},{text:"Source Sans Pro",
value:"Source Sans Pro"},{text:"Space Mono",value:"Space Mono"},{text:"Ubuntu",value:"Ubuntu"},{text:"Ubuntu Mono",value:"Ubuntu Mono"}],b=0,e=c.length;b<e;){var f=c[b];f.selected=a==f.value;b++}c.sort(function(a,c){return a.text.localeCompare(c.text)});return c}function gc(a,c){return function(){W();a(c)}}function hc(){for(var a=[],c=0,b="#000000 #ffffff #ffc0cb #ff0000 #008080 #00ffff;#0000ff #eeeeee #ffd700 #ff7373 #40e0d0 #b0e0e6;#FFA849 #005800 #003500 #002300 #000070 #00005C;#00003A #000020 #3BAD4D #215B2A #9EC85C #0094FF;#12279F #521A00 #361C0F #5B5232 #353123 #A69D7C;#ffe4e1 #c0c0c0 #cccccc #d3ffce #7fffd4 #333333;#666666 #f6546a #ffa500 #00ff00 #f0f8ff #003366;#468499 #ffff00 #800080 #f5f5f5 #00ced1 #088da5;#fff68f #fa8072 #e6e6fa #660066 #ffc3a0 #ff6666;#20b2aa #faebd7 #c6e2ff #66cdaa #ffb6c1 #800000;#990000 #f5f5dc #afeeee #81d8d0 #cbbeb5 #f08080;#ccff00 #ff00ff #008000 #808080 #999999 #c39797;#c0d6e4 #00ff7f #0e2f44 #3b5998 #b6fcd5 #66cccc;#ffdab9 #ff4040 #dddddd #8b0000 #b4eeb4 #f7f7f7;#daa520 #31698a #6897bb #191970 #cc0000 #a0db8e;#0099cc #FFE26C #3399ff #ff4444 #8a2be2 #000080;#404040 #191919 #4169e1 #ff7f50 #794044 #6dc066".split(";"),
e=b.length;c<e;){var f=b[c].split(" ");a.push(f);c++}return a}function hb(a,c){for(var d=0,e=c.length;d<e;){var f=c[d],g=m(a,"td"),g=m(g,"img");g.id=f.id;g.width=40;g.height=40;g.src=b.imageBase+f.image;g.onclick=f.command;g.ondragstart=function(a){return!1};var h=b.translate(f.tooltip);if(f.shortcut)var k=b.translate("MES_KEY"),h=h+(". "+k+": "+f.shortcut);b.tooltip.make(g,h);d++}}function Ab(a){var c=[],b;for(b=10;20>=b;)Y(b,a,c),b++;for(b=22;30>=b;)Y(b,a,c),b+=2;Y(36,a,c);Y(48,a,c);return c}function na(a){return a.items&&
0!=a.items.length?va(a):a.nodes?a:null}function ia(a){Aa(a);u({align:a})}function wb(){Z("bold")}function ic(a){b.dialogs.currentColor=a.target.value;Sa()}function zb(a){b.dialogs.family=a.value;Z("family")}function sb(a){var c=b.dialogs;c.fillType=a.target.checked?"gradient":"solid";c.fillColor0||(c.fillColor0=Theme.getIconBack("action"));ya(c.fillColor0)}function xb(){Z("italic")}function jc(a){if(b.onReadonly)b.onReadonly(a)}function tb(a){var c=b.dialogs;c.shadow=a.target.checked;u({shadow:c.shadow})}
function Bb(a){b.dialogs.size=a.value;Z("size")}function kc(){b.showToolbar=!b.showToolbar;Oa();X();b.view.rebuild()}function Xb(a){b.toolName=a.target.value;N();pa();b.saveUserSettings({toolbar:b.toolName})}function Yb(a){b.toolNameFree=a.target.value;N();pa();b.saveUserSettings({toolbarFree:b.toolNameFree})}function aa(a,c){a*=Config.KEY_SCROLL;c*=Config.KEY_SCROLL;var d=b.view.getZoom();b.view.scrollBy(a/d,c/d)}function lc(a){a=JSON.parse(a);if(!b.readonly){b.readonly=!0;a=na(a);var c=b.editor,
d=b.view;ba();c.loadDiagram(a);c.autoSizeIcons();c.clearUndo();c.redraw();d.rebuild();J();b.readonly=!1;a=c.getDiagramAsItems();a={editType:"replace",name:a.name,items:a.items,background:a.background||"",diaLine:a.diaLine||"",diaLineThickness:a.diaLineThickness||"",font:a.font||Utils.buildFontString(!1,!1,Config.FONT_SIZE,Config.FONT_FAMILY)};ua(b,a);b.storage.saveChanges(a)}}function rb(a,c){var d=b.dialogs;d.textColor=a.textColor;d.lineColor=a.lineColor;d.secondaryColor=a.secondaryColor;d.allowSecondary=
a.allowSecondary;d.align=a.align;d.shadow=a.shadow;d.lineStyle=a.lineStyle;d.arrowStart=a.arrowStart;d.arrowEnd=a.arrowEnd;if(a.fillColor)if(7==a.fillColor.length)d.fillType="solid",d.fillColor0=a.fillColor,d.fillColor1="";else{var e=a.fillColor.split(" ");3==e.length&&"gradient"==e[0]?(d.fillType="gradient",d.fillColor0=e[2],d.fillColor1=e[1]):(d.fillType="solid",d.fillColor0="",d.fillColor1="")}else d.fillType="solid",d.fillColor0="",d.fillColor1="";e=parseInt(a.lineThickness);isNaN(e)?d.lineThickness=
1:d.lineThickness=e;for(var e=new P("italic"),f=new P("bold"),g=new P("size"),h=new P("family"),k=0,m=c.length;k<m;){var l=Utils.parseFontString(c[k]);ca(e,l);ca(f,l);ca(g,l);ca(h,l);k++}U(e,d);U(f,d);U(g,d);U(h,d);e=c.map(Utils.fontToFace);e=Utils.listToSet(e);e=Object.keys(e);d.faces=e}function sa(){var a;(a=b.readonly)||(a=0!=b.added.length||0!=b.updated.length||0!=b.removed.length||b.changes?!0:!1,a=!a);a||b.delay||(b.changes=!1,a=ra(b),b.storage.saveChanges(a),ba())}function Y(a,c,b){b.push({text:a+
" px",value:a,selected:a==c})}function ab(a){b.removed.push(String(a))}function ba(){b.added=[];b.removed=[];b.updated=[]}function Vb(){var a=HtmlUtils.getValue("link_text");Ea(a)}function Ra(a){if(a){var c=b.userColors.slice(0);if(-1==c.indexOf(a)){for(c.unshift(a);6<c.length;)c.pop();b.userColors=c;b.saveUserSettings({colors:c})}}}function da(){var a={zoom:b.view.getZoom()};b.saveUserSettings(a)}function E(a,c,b,e,f){var g=a.style;g.position="absolute";g.display="inline-block";oa(a,c,b,e,f)}function mc(a){p("ec:setArrowEnd");
a=a.value;b.dialogs.arrowEnd=a;u({arrowEnd:a})}function nc(a){p("ec:setArrowStart");a=a.value;b.dialogs.arrowStart=a;u({arrowStart:a})}function kb(a){p("ec:setBackgroundColor");b.dialogs.backColorButt.style.background=a;b.editor.setBackground({background:a});b.view.redraw();w()}function ta(a,c){c?(a.style.background=c,a.style.cursor="pointer"):(a.style.backgroundImage="url('"+b.imageBase+"no-color.png')",a.style.backgroundSize="30px 30px",a.style.cursor="default")}function Ga(a){a.label.innerHTML=
"";for(var c=0,b=a.items,e=b.length;c<e;){var f=b[c];f.selected&&(f=y.createTextNode(f.text),a.label.appendChild(f));c++}}function mb(a){p("ec:setDLT");b.editor.setBackground({diaLineThickness:a.value});b.view.redraw()}function ob(){Da(b.background,b.diaLine,b.diaLineThickness)}function Da(a,c,d){b.saveUserSettings({background:a,diaLine:c,diaLineThickness:d});b.userBackground=a;b.userDiaLine=c;b.userDiaLineThickness=d}function Cb(a){a=b.dialogs;a=Utils.buildFontString(a.italicButt.on,a.boldButt.on,
a.size,a.family);b.saveUserSettings({font:a});b.userFont=a;w()}function Jb(){var a=b.dialogs,c={};c.fillColor=Ma();c.textColor=a.textColor;c.lineColor=a.lineColor;c.secondaryColor=a.secondaryColor;c.shadow=a.shadow;c.lineThickness=a.lineThickness;c.lineStyle=a.lineStyle;b.saveUserSettings({shape:c});b.userShape=c;w()}function lb(a){p("ec:setDiaLineColor",[a]);a&&(b.dialogs.diaLineColorButt.style.background=a);b.editor.setBackground({diaLine:a});b.view.redraw()}function ha(a,c){var d=b.dialogs.dialog;
HtmlUtils.setPosCorrected(a,c,d);HtmlUtils.setUpMovable(d,30)}function ja(a){a.style.border="solid 1px #455A64";a.style.boxShadow="0px 0px 5px rgba(0, 0, 0, 0.3)";a.style.width="280px";a.style.position="absolute";a.style.background="white"}function ya(a){p("ec:setFillColor",[a]);var c=b.dialogs;c.fillColor0=a;c.fillColorButt.style.background=a;a={fillColor:Ma()};u(a)}function Z(a){var c=b.dialogs,d=c.italicButt.on,e=c.boldButt.on,f=c.size,c=c.family;p("ec:setFont",[a,d,e,f,c]);var g=Ob(a,d,e,f,c);
"size"==a?ka(a,g):(d=Wb(a,g),0==d.length?ka(a,g):(e=new oc,e.onLoaded=function(){ka(a,g)},e.start(d)))}function u(a){p("ec:setFormat",[a]);b.editor.setFormat(b.dialogs.ids,a);b.view.redraw()}function Db(a){p("ec:setLineColor",[a]);var c=b.dialogs;c.lineColor=a;c.lineColorButt.style.background=a;u({lineColor:a})}function Ea(a){var c=b.dialogs;a=(a||"").trim();c.content.link=a;b.editor.setContent(c.itemId,c.content);b.view.redraw()}function v(a,c,b,e){c in a&&(b[e||c]=a[c])}function oa(a,c,b,e,f){a=
a.style;a.left=c+"px";a.top=b+"px";a.width=e+"px";a.height=f+"px"}function ca(a,b){var d=b[a.name];null!=d&&(null==a.value?a.value=d:a.value!=d&&(a.different=!0))}function ub(a){p("ec:setSecondaryColor",[a]);var c=b.dialogs;c.secondaryColor=a;c.secondaryColorButt.style.background=a;u({secondaryColor:a})}function pc(a){a=a.value;p("ec:setStyle",[a]);b.dialogs.lineStyle=a;u({lineStyle:a})}function vb(a){p("ec:setTextColor",[a]);var c=b.dialogs;c.textColor=a;c.textColorButt.style.background=a;u({textColor:a})}
function Eb(a){a=a.value;p("ec:setThickness",[a]);b.dialogs.lineThickness=a;u({lineThickness:a})}function Ta(a){b.toolName=a;N()}function qc(){var a=new ItemsModule(b.translate);Drakon.setItems(a);var c=new ViewWidget(C,y,b.canvas,b.over,a),d=new Canvas(C,y),e=new Editor(d,new Za,a,b.translate,Xa),f=new Behaviour(e,d,c,{click:rc,onFinishZoom:da,openSub:b.openSub},C,b.context);c.setPayload(f);e.setCallback("showInputBox",cc);e.setCallback("getClipboard",$b);e.setCallback("getClipboardType",ac);e.setCallback("copyToClipboard",
Sb);e.setCallback("commandDone",Rb);e.setCallback("showWarningPopup",sc);e.setCallback("changeBackground",jb);e.setCallback("changeFormat",qb);e.setCallback("getDefault",bc);e.setCallback("editLink",Ub);e.setCallback("followLink",Zb);e.setCallback("changeYesNo",Lb);e.setCallback("showContextMenu",tc);e.setCallback("findReferences",b.findReferences);b.editor=e;b.view=c;b.beh=f;b.cnv=d;b.items=a}function V(a,b){var d=y.getElementById(a);if(d)d.style.display=b||"block";else throw Error("Element '"+a+
"' not found");}function Aa(a){var c=b.dialogs;if("left"===a)r(c.alignLeftButt,!0),r(c.alignRightButt,!1),r(c.alignCenterButt,!1);else if("center"===a)r(c.alignLeftButt,!1),r(c.alignRightButt,!1),r(c.alignCenterButt,!0);else{if("right"!==a)throw"Unexpected switch value: "+a;r(c.alignLeftButt,!1);r(c.alignRightButt,!0);r(c.alignCenterButt,!1)}}function Hb(a){for(var c=b.dialogs.arrowEnd||"",d=[{value:"",image:"cap-solid.png"},{value:"arrow",image:"cap-arrow-right.png"},{value:"sarrow",image:"cap-sarrow-right.png"},
{value:"warrow",image:"cap-warrow-right.png"},{value:"paw",image:"cap-paw-right.png"}],e=0,f=d.length;e<f;){var g=d[e];g.selected=g.value==c;e++}O(a.div,"MES_ARROW_HEAD",d,mc)}function Gb(a){for(var c=b.dialogs.arrowStart||"",d=[{value:"",image:"cap-solid.png"},{value:"arrow",image:"cap-arrow-left.png"},{value:"sarrow",image:"cap-sarrow-left.png"},{value:"warrow",image:"cap-warrow-left.png"},{value:"paw",image:"cap-paw-left.png"}],e=0,f=d.length;e<f;){var g=d[e];g.selected=g.value==c;e++}O(a.div,
"MES_ARROW_TAIL",d,nc)}function db(a,c,d,e){b.dialogs.currentColor=c;var f;d=Ja();a=HtmlUtils.rect(a);d.innerHTML="";ja(d);d.style.boxShadow="0px 0px 15px rgba(0, 0, 0, 0.6)";var g=m(d,"div");g.style.paddingLeft="5px";g.style.paddingRight="5px";g.style.marginTop="5px";g.style.marginBottom="5px";var h=b.userColors.slice(0);for(f=0;6>f;){var k=h[f],l=ec(e,k);Q(g,k,1,l);f++}f=m(d,"div");f.style.height="260px";f.style.overflowY="scroll";f=m(f,"div");g=0;h=hc();for(k=h.length;g<k;){var n=h[g],l=m(f,"div");
l.style.paddingLeft="5px";l.style.paddingRight="5px";for(var p=0,q=n.length;p<q;){var r=n[p],r=Q(l,r,1,dc(e,r));r.style.marginBottom="0px";r.style.marginTop="0px";p++}g++}f=m(d,"div");d=function(){};g=Q(f,c,5,d);g.style.marginRight="10px";g.style.verticalAlign="bottom";b.dialogs.selColor=g;g.onclick=Qa(e);g=m(f,"input");g.type="text";g.value=c;g.style.border="solid 1px #455A64";g.style.width="75px";g.style.padding="2px";g.oninput=ic;c=m(f,"div");c.className="panic_button";c.style.display="inline-block";
HtmlUtils.setDivText(c,b.translate("MES_APPLY"));c.onclick=d;c.style.margin="5px";c.style.fontSize="90%";c.onclick=Qa(e);b.dialogs.apply=c;Sa();HtmlUtils.setPosCorrected(a.left-10,a.bottom,b.dialogs.popup)}function Tb(a){O(a.div,b.translate(a.title),a.items,function(b){for(var d=0,e=a.items,f=e.length;d<f;){var g=e[d];g.selected=g==b;d++}Ga(a);a.onSelected(b)})}function tc(a,c,d){d={rows:d.map(uc)};b.context(a,c,d,null,null)}function O(a,c,d,e){var f=Ja();f.innerHTML="";ja(f);f.style.boxShadow="0px 0px 15px rgba(0, 0, 0, 0.6)";
var g=m(f,"div");g.style.maxHeight="250px";g.style.overflowY="scroll";g=m(g,"table");g.width="100%";var h=m(g,"tr"),h=m(h,"td");h.colSpan="2";HtmlUtils.setDivText(h,b.translate(c));h.style.background="#f0f0f0";h.style.padding="5px";c=0;for(h=d.length;c<h;){var k=d[c],l=m(g,"tr"),n=m(l,"td");n.width="10";var p=m(l,"td");p.width="100*";p.style.cursor="pointer";p.onclick=gc(e,k);fc(l);k.image?(l=m(p,"img"),l.verticalAlign="middle",l.src=b.imageBase+k.image,l.width=120,l.height=30,p.style.padding="0px",
p.style.paddingTop="2px",f.style.width="150px"):(HtmlUtils.setDivText(p,k.text),p.style.padding="5px");k.selected&&(k=m(n,"img"),k.verticalAlign="bottom",k.src=b.imageBase+"item-pointer.png",k.width=10,k.height=10);c++}a=HtmlUtils.rect(a);HtmlUtils.setPosCorrected(a.left,a.bottom,b.dialogs.popup)}function Ua(a,c){var d=a.getBoundingClientRect();b.context((d.left+d.right)/2,(d.top+d.bottom)/2,c,null)}function F(a){b.editor.showInsertionSockets("mind-"+a);b.view.redraw()}function q(a){"mind"==b.type?
(a={action:"action","case":"collection",raction:"raction",select:"beginend",insertion:"insertion",shelf:"shelf"}[a])&&F(a):"raction"!=a&&(b.editor.showInsertionSockets(a),b.view.redraw())}function Fb(a){for(var c=b.dialogs.lineStyle||"solid",d=[{value:"solid",image:"ls-solid.png"},{value:"s-1",image:"ls-style-1.png"},{value:"s-2",image:"ls-style-2.png"},{value:"s-3",image:"ls-style-3.png"},{value:"s-4",image:"ls-style-4.png"}],e=0,f=d.length;e<f;){var g=d[e];g.selected=g.value==c;e++}O(a.div,"MES_STYLE",
d,pc)}function vc(){for(var a=[],b=0,d=[[["theme11.png","#FFFFFF","#000000","#000000","#000000","#000000","#c0d0ff","#b0b0b0",[["insertion","#ffffff","#000000","#000000","#ffffff"],["loopbegin","#FFFFE0","#000000","#000000"],["callout","#FFFC96","#000000","#000000"]]],["theme12.png","#FFFFFF","#000000","#000000","#000000","#000000","#FFFFFF","#ffffff",[["insertion","#ffffff","#000000","#000000","#ffffff"]]],["theme13.png","#FFFFFF","#000000","#827D7D","#000000","#000000","#DADEFF","#b0b0b0",[["insertion",
"#ffffff","#000000","#827D7D","#ffffff"],["callout","#FFFC96","#000000","#000000"]]],["theme14.png","#FFFFFF","#000000","#000000","#000000","#000000","#c0d0ff","#b0b0b0",[["insertion","#ffffff","#000000","#000000","#ffffff"],["question","#ffffd3","#000000","#000000"],["select","#ffdbdb","#000000","#000000"],["loopbegin","#deffde","#000000","#000000"],["callout","#FFFC96","#000000","#000000"]]]],[["theme21.png","#568FFF","#ffffff","none","#000000","#000000","#ffffff","#B1CAFF",[["question","#436AB9",
"#ffffff","none"],["insertion","#568FFF","#ffffff","none","#436AB9"],["loopbegin","#5A72A2","#ffffff","none"],["callout","#FFFC96","#000000","#626262"],["comment","#568FFF","#ffffff","none"]]],["theme22.png","#568FFF","#ffffff","none","#000000","#000000","#ffffff","#B1CAFF",[["question","#2A9E4B","#ffffff","none"],["insertion","#568FFF","#ffffff","none","#436AB9"],["loopbegin","#3EBD62","#ffffff","none"],["callout","#FFFC96","#000000","#626262"],["comment","#568FFF","#ffffff","none"]]],["theme23.png",
"#568FFF","#ffffff","none","#000000","#000000","#ffffff","#B1CAFF",[["question","#ffffff","#000000","#00137F"],["insertion","#568FFF","#ffffff","none","#436AB9"],["loopbegin","#5A72A2","#ffffff","none"],["callout","#FFFC96","#000000","#626262"],["comment","#568FFF","#ffffff","none"]]],["theme24.png","#FFE26C","#000000","none","#000000","#000000","#ffffff","#FFA849",[["question","#FFA849","#000000","none"],["insertion","#FFE26C","#000000","none","#CBB145"],["loopbegin","#F2C371","#000000","none"],
["callout","#FCFCFC","#000000","#626262"],["comment","#FFE26C","#000000","none"]]]],[["theme31.png","#EDEEF0","#000000","#A0A0A0","#000000","#000000","#ffffff","#C2C0C0",[["question","#DE3E26","#ffffff","#A0A0A0"],["insertion","#EDEEF0","#000000","#A0A0A0","#C2C0C0"],["loopbegin","#FF5454","#000000","#A0A0A0"],["callout","#FFFFF0","#000000","#626262"],["comment","#EDEEF0","#000000","#A0A0A0"]]],["theme32.png","#EDEEF0","#000000","#A0A0A0","#000000","#000000","#ffffff","#C2C0C0",[["question","#EDEEF0",
"#000000","#A0A0A0"],["insertion","#EDEEF0","#000000","#A0A0A0","#C2C0C0"],["loopbegin","#EDEEF0","#000000","#A0A0A0"],["callout","#FFFFF0","#000000","#626262"],["comment","#EDEEF0","#000000","#A0A0A0"]]],["theme33.png","#EDEEF0","#000000","#A0A0A0","#000000","#000000","#ffffff","#C2C0C0",[["question","#C2C0C0","#000000","#A0A0A0"],["insertion","#EDEEF0","#000000","#A0A0A0","#C2C0C0"],["loopbegin","#A0A0A0","#000000","#A0A0A0"],["callout","#FFFFF0","#000000","#626262"],["comment","#EDEEF0","#000000",
"#A0A0A0"]]],["theme34.png","#ffffff","#000000","none","#000000","#000000","#3BAD4D","#9EC85C",[["question","#215B2A","#ffffff","none"],["insertion","#EDEEF0","#000000","none","#9EC85C"],["loopbegin","#9EC85C","#000000","none"],["callout","#FFFFF0","#000000","#626262"],["comment","#EDEEF0","#000000","none"]]]],[["theme41.png","#EDEEF0","#000000","#A0A0A0","#000000","#000000","#ffffff","#C2C0C0",[["question","#436AB9","#ffffff","#A0A0A0"],["insertion","#EDEEF0","#000000","#A0A0A0","#C2C0C0"],["loopbegin",
"#5A72A2","#ffffff","#A0A0A0"],["callout","#FFFFF0","#000000","#626262"],["comment","#EDEEF0","#000000","#A0A0A0"]]],["theme42.png","#F5EBE4","#000000","#000000","#000000","#000000","#FFFFFF","#b0b0b0",[["insertion","#F5EBE4","#000000","#000000","#F5EBE4"],["question","#e5e6e4","#000000","#000000"],["select","#cfd2cd","#000000","#000000"],["loopbegin","#CAC8C8","#000000","#000000"],["callout","#FFFC96","#000000","#000000"]]],["theme43.png","#bfd8bd","#000000","#597A62","#000000","#000000","#FFFFFF",
"#70b070",[["insertion","#bfd8bd","#000000","#597A62","#bfd8bd"],["question","#edeec9","#000000","#597A62"],["select","#98c9a3","#000000","#597A62"],["loopbegin","#98c9a3","#000000","#597A62"],["callout","#FFFC96","#000000","#000000"]]],["theme44.png","#ffffff","#000000","none","#000000","#000000","#0094FF","#7FC9FF",[["question","#12279F","#ffffff","none"],["insertion","#ffffff","#000000","none","#7FC9FF"],["loopbegin","#7FC9FF","#000000","none"],["callout","#FFFFF0","#000000","#626262"],["comment",
"#ffffff","#000000","none"]]]],[["theme51.png","#000000","#ffffff","#B2B2B2","#ffffff","#ffffff","#000000","#000000",[["insertion","#000000","#ffffff","#B2B2B2","#000000"],["callout","#000000","#ffffff","#B2B2B2"]]],["theme52.png","#000000","#ace4ff","#6B6DFF","#ace4ff","#ace4ff","#000540","#000080",[["insertion","#000000","#ace4ff","#6B6DFF","#000000"],["callout","#000590","#ace4ff","#6B6DFF"]]],["theme53.png","#000000","#fff1c8","#797954","#fff1c8","#fff1c8","#000020","#000080",[["insertion","#000000",
"#fff1c8","#797954","#000000"],["question","#1f1f00","#fff1c8","#999974"],["select","#250100","#fff1c8","#999974"],["loopbegin","#042d00","#fff1c8","#999974"],["callout","#000590","#fff1c8","#999974"]]],["theme54.png","#000000","#4aff4d","#008000","#4aff4d","#4aff4d","#000000","#007000",[["insertion","#000000","#4aff4d","#008000","#000000"],["question","#002400","#4aff4d","#008000"],["select","#000000","#4aff4d","#008000"],["loopbegin","#005100","#4aff4d","#008000"],["callout","#002400","#4aff4d",
"#008000"]]]],[["theme61.png","#FFFFFF","#000000","#b0b0b0","#000000","#000000","#FFFFFF","#d0d0d0",[["insertion","#ffffff","#000000","#b0b0b0","#ffffff"],["callout","#FFFFF0","#000000","#b0b0b0"]],2],["theme62.png","#AFF0DD","#000000","#00987E","#000000","#000000","#ffffff","#8FD6C2",[["question","#8FD6C2","#000000","#00987E"],["insertion","#AFF0DD","#000000","#00987E","#8FD6C2"],["loopbegin","#85C2C5","#000000","#00987E"],["callout","#FFFFF0","#000000","#00987E"],["comment","#AFF0DD","#000000",
"#00987E"]],2],["theme63.png","#C4E2F8","#000000","#5C9CCB","#000000","#000000","#ffffff","#80BFEF",[["question","#96CBF3","#000000","#5C9CCB"],["insertion","#C4E2F8","#000000","#5C9CCB","#80BFEF"],["loopbegin","#80BFEF","#000000","#5C9CCB"],["callout","#FFFFF0","#000000","#5C9CCB"],["comment","#C4E2F8","#000000","#5C9CCB"]],2],["theme64.png","#fff68f","#000000","#9B9262","#000000","#000000","#FFFFFF","#E6C543",[["question","#E6C543","#000000","#9B9262"],["insertion","#fff68f","#000000","#9B9262",
"#E6C543"],["callout","#fff64f","#000000","#9B9262"]],2]],[["theme71.png","#FFFFFF","#000000","#b0b0b0","#000000","#000000","#FFFFFF","#d0d0d0",[["insertion","#ffffff","#000000","#b0b0b0","#ffffff"],["callout","#FFFFF0","#000000","#b0b0b0"]],3],["theme72.png","#AFF0DD","#000000","#00987E","#000000","#000000","#ffffff","#8FD6C2",[["question","#8FD6C2","#000000","#00987E"],["insertion","#AFF0DD","#000000","#00987E","#8FD6C2"],["loopbegin","#85C2C5","#000000","#00987E"],["callout","#FFFFF0","#000000",
"#00987E"],["comment","#AFF0DD","#000000","#00987E"]],3],["theme73.png","#C4E2F8","#000000","#5C9CCB","#000000","#000000","#ffffff","#80BFEF",[["question","#96CBF3","#000000","#5C9CCB"],["insertion","#C4E2F8","#000000","#5C9CCB","#80BFEF"],["loopbegin","#80BFEF","#000000","#5C9CCB"],["callout","#FFFFF0","#000000","#5C9CCB"],["comment","#C4E2F8","#000000","#5C9CCB"]],3],["theme74.png","#fff68f","#000000","#9B9262","#000000","#000000","#FFFFFF","#E6C543",[["question","#E6C543","#000000","#9B9262"],
["insertion","#fff68f","#000000","#9B9262","#E6C543"],["callout","#fff64f","#000000","#9B9262"]],3]]],e=d.length;b<e;){for(var f=[],g=0,h=d[b],k=h.length;g<k;)f.push(ib(h[g])),g++;a.push(f);b++}a={rows:a,isGrid:!0};b=la("tt_theme");Ua(b,a)}function xa(a,b,d,e){for(var f=[];5>=b;)f.push({value:b,text:b+" px",selected:b==d}),b++;O(a.div,"MES_THICKNESS",f,e)}function sc(a){b.warning(a)}function wc(){var a=b.translate("BUT_ZOOM_IN"),c=b.translate("BUT_ZOOM_OUT"),a=[{text:a,code:xc},{text:c,code:yc},{type:"separator"},
{text:"200%",code:function(){A(200)}},{text:"150%",code:function(){A(150)}},{type:"separator"},{text:"100%",code:function(){A(100)}},{type:"separator"},{text:"90%",code:function(){A(90)}},{text:"80%",code:function(){A(80)}},{text:"70%",code:function(){A(70)}},{text:"50%",code:function(){A(50)}},{text:"25%",code:function(){A(25)}}],c=la("tt_zoom");Ua(c,{rows:a})}function Va(){b.freeScroll=!0;b.beh.startFreeScroll();X();b.view.rebuild()}function zc(){b.freeScroll=!1;b.beh.endFreeScroll();X();b.view.rebuild()}
function r(a,b){a.div.style.background=b?a.active:a.idle;a.on=b}function Ac(){p("ec:toggleSilhouette");b.editor.toggleSilhouette();J()}function gb(){p("ec:toggleTreeType");b.editor.toggleTreeType();b.view.redraw()}function rc(){}function bb(a){b.updated.push(Utils.copyItem(a))}function Oa(){var a=b.leftButts[0];a.div.src=Ka(a.button,b.showToolbar?"left":"right")}function Sa(){var a=b.dialogs.currentColor,c,d;Utils.isColor(a)?(c="#455A64",d="pointer"):(c="grey",d="default",a="");var e=b.dialogs.apply;
e.style.background=c;e.style.cursor=d;ta(b.dialogs.selColor,a)}function cb(a){qa(b,a)}function qa(a,c){v(c,"name",a,null);v(c,"background",a,null);v(c,"diaLine",a,null);v(c,"diaLineThickness",a,null);v(c,"font",a,null);b.changes=!0}function pa(){var a=0;b.readonly?(t("dia-mind"),t("dia-free"),t("dia-icons"),b.ro.style.display="inline-block",b.onReadonly?(b.ro.className="panic_button",b.ro.style.background="coral"):(b.ro.className="dlg_button",b.ro.style.background="black")):(a=b.type,"drakon"===a?
(t("dia-mind"),t("dia-free"),V("dia-icons","block")):"mind"===a?(t("dia-free"),t("dia-icons"),V("dia-mind","block")):(t("dia-mind"),t("dia-icons"),V("dia-free","block")),z(b.ro))}function uc(a){return{text:a.text,image:a.image,code:function(c,d){a.text&&CallTrace.add("cm:"+a.text);a.code(c,d);b.view.hideOver();b.view.redraw()}}}function xc(){b.view.zoomIn();da()}function yc(){b.view.zoomOut();da()}function A(a){b.view.zoomTo(a/100);da();J()}function oc(){var a=this;a.type_name="ManyFontLoader";a.state=
"Normal";a.fontLoaded=function(b){if("Normal"==a.state)a.current++,a.current==a.faces.length?(a.onLoaded(),a.state=null):(Pa(a),a.state="Normal");else return null};a.start=function(b){if("Normal"==a.state)a.current=0,a.faces=b,Pa(a),a.state="Normal";else return null}}var b={groups:[],delay:!1,readonly:!1,onReadonly:null,toolName:"basic",toolNameFree:"free-basic",toolNameMind:"dia-mind",userColors:[],movable:null,leftButts:[],rightButts:[]},R={};h(!1,!1,"PT Mono","PTM55FT.ttf");h(!1,!0,"PT Mono","PTM55FT.ttf");
h(!0,!1,"PT Mono","PTM55FT.ttf");h(!0,!0,"PT Mono","PTM55FT.ttf");h(!1,!1,"Fira Code","FiraCode-Regular.otf");h(!1,!0,"Fira Code","FiraCode-Regular.otf");h(!0,!1,"Fira Code","FiraCode-Regular.otf");h(!0,!0,"Fira Code","FiraCode-Regular.otf");h(!1,!1,"Liberation Sans","LiberationSans.ttf");h(!1,!0,"Liberation Sans","LiberationSans-Bold.ttf");h(!0,!1,"Liberation Sans","LiberationSans-Italic.ttf");h(!0,!0,"Liberation Sans","LiberationSans-BoldItalic.ttf");h(!1,!1,"Arimo","Arimo-Regular.ttf");h(!1,!0,
"Arimo","Arimo-Bold.ttf");h(!0,!1,"Arimo","Arimo-Italic.ttf");h(!0,!0,"Arimo","Arimo-BoldItalic.ttf");h(!1,!1,"Cousine","Cousine-Regular.ttf");h(!1,!0,"Cousine","Cousine-Bold.ttf");h(!0,!1,"Cousine","Cousine-Italic.ttf");h(!0,!0,"Cousine","Cousine-BoldItalic.ttf");h(!1,!1,"Tinos","Tinos-Regular.ttf");h(!1,!0,"Tinos","Tinos-Bold.ttf");h(!0,!1,"Tinos","Tinos-Italic.ttf");h(!0,!0,"Tinos","Tinos-BoldItalic.ttf");h(!1,!1,"Alegreya Sans","AlegreyaSans-Regular.ttf");h(!1,!0,"Alegreya Sans","AlegreyaSans-Bold.ttf");
h(!0,!1,"Alegreya Sans","AlegreyaSans-Italic.ttf");h(!0,!0,"Alegreya Sans","AlegreyaSans-BoldItalic.ttf");h(!1,!1,"Anonymous Pro","AnonymousPro-Regular.ttf");h(!1,!0,"Anonymous Pro","AnonymousPro-Bold.ttf");h(!0,!1,"Anonymous Pro","AnonymousPro-Italic.ttf");h(!0,!0,"Anonymous Pro","AnonymousPro-BoldItalic.ttf");h(!1,!1,"Cormorant Garamond","CormorantGaramond-Regular.ttf");h(!1,!0,"Cormorant Garamond","CormorantGaramond-Bold.ttf");h(!0,!1,"Cormorant Garamond","CormorantGaramond-Italic.ttf");h(!0,!0,
"Cormorant Garamond","CormorantGaramond-BoldItalic.ttf");h(!1,!1,"Crimson Text","CrimsonText-Roman.ttf");h(!1,!0,"Crimson Text","CrimsonText-Bold.ttf");h(!0,!1,"Crimson Text","CrimsonText-Italic.ttf");h(!0,!0,"Crimson Text","CrimsonText-BoldItalic.ttf");h(!1,!1,"Lato","lato-regular-webfont.ttf");h(!1,!0,"Lato","lato-bold-webfont.ttf");h(!0,!1,"Lato","Lato-Italic.ttf");h(!0,!0,"Lato","Lato-BoldItalic.ttf");h(!1,!1,"Lora","Lora-Regular.ttf");h(!1,!0,"Lora","Lora-Bold.ttf");h(!0,!1,"Lora","Lora-Italic.ttf");
h(!0,!0,"Lora","Lora-BoldItalic.ttf");h(!1,!1,"Merriweather","Merriweather-Regular.ttf");h(!1,!0,"Merriweather","Merriweather-Bold.ttf");h(!0,!1,"Merriweather","Merriweather-Italic.ttf");h(!0,!0,"Merriweather","Merriweather-BoldItalic.ttf");h(!1,!1,"Noto Sans","NotoSans-Regular.ttf");h(!1,!0,"Noto Sans","NotoSans-Bold.ttf");h(!0,!1,"Noto Sans","NotoSans-Italic.ttf");h(!0,!0,"Noto Sans","NotoSans-BoldItalic.ttf");h(!1,!1,"Open Sans","OpenSans-Regular.ttf");h(!1,!0,"Open Sans","OpenSans-Bold.ttf");
h(!0,!1,"Open Sans","OpenSans-Italic.ttf");h(!0,!0,"Open Sans","OpenSans-BoldItalic.ttf");h(!1,!1,"PT Sans","PT_Sans-Web-Regular.ttf");h(!1,!0,"PT Sans","PT_Sans-Web-Bold.ttf");h(!0,!1,"PT Sans","PT_Sans-Web-Italic.ttf");h(!0,!0,"PT Sans","PT_Sans-Web-BoldItalic.ttf");h(!1,!1,"PT Serif","PT_Serif-Web-Regular.ttf");h(!1,!0,"PT Serif","PT_Serif-Web-Bold.ttf");h(!0,!1,"PT Serif","PT_Serif-Web-Italic.ttf");h(!0,!0,"PT Serif","PT_Serif-Web-BoldItalic.ttf");h(!1,!1,"Raleway","Raleway-Regular.ttf");h(!1,
!0,"Raleway","Raleway-Bold.ttf");h(!0,!1,"Raleway","Raleway-Italic.ttf");h(!0,!0,"Raleway","Raleway-BoldItalic.ttf");h(!1,!1,"Roboto","Roboto-Regular.ttf");h(!1,!0,"Roboto","Roboto-Bold.ttf");h(!0,!1,"Roboto","Roboto-Italic.ttf");h(!0,!0,"Roboto","Roboto-BoldItalic.ttf");h(!1,!1,"Roboto Condensed","RobotoCondensed-Regular.ttf");h(!1,!0,"Roboto Condensed","RobotoCondensed-Bold.ttf");h(!0,!1,"Roboto Condensed","RobotoCondensed-Italic.ttf");h(!0,!0,"Roboto Condensed","RobotoCondensed-BoldItalic.ttf");
h(!1,!1,"Roboto Mono","RobotoMono-Regular.ttf");h(!1,!0,"Roboto Mono","RobotoMono-Bold.ttf");h(!0,!1,"Roboto Mono","RobotoMono-Italic.ttf");h(!0,!0,"Roboto Mono","RobotoMono-BoldItalic.ttf");h(!1,!1,"Source Code Pro","SourceCodePro-Regular.ttf");h(!1,!0,"Source Code Pro","SourceCodePro-Bold.ttf");h(!0,!1,"Source Code Pro","SourceCodePro-Regular.ttf");h(!0,!0,"Source Code Pro","SourceCodePro-Regular.ttf");h(!1,!1,"Source Sans Pro","SourceSansPro-Regular.ttf");h(!1,!0,"Source Sans Pro","SourceSansPro-Bold.ttf");
h(!0,!1,"Source Sans Pro","SourceSansPro-Italic.ttf");h(!0,!0,"Source Sans Pro","SourceSansPro-BoldItalic.ttf");h(!1,!1,"Space Mono","SpaceMono-Regular.ttf");h(!1,!0,"Space Mono","SpaceMono-Bold.ttf");h(!0,!1,"Space Mono","SpaceMono-Italic.ttf");h(!0,!0,"Space Mono","SpaceMono-BoldItalic.ttf");h(!1,!1,"Titillium Web","TitilliumWeb-Regular.ttf");h(!1,!0,"Titillium Web","TitilliumWeb-Bold.ttf");h(!0,!1,"Titillium Web","TitilliumWeb-Italic.ttf");h(!0,!0,"Titillium Web","TitilliumWeb-BoldItalic.ttf");
h(!1,!1,"Ubuntu","Ubuntu-Regular.ttf");h(!1,!0,"Ubuntu","Ubuntu-Bold.ttf");h(!0,!1,"Ubuntu","Ubuntu-Italic.ttf");h(!0,!0,"Ubuntu","Ubuntu-BoldItalic.ttf");h(!1,!1,"Ubuntu Mono","UbuntuMono-Regular.ttf");h(!1,!0,"Ubuntu Mono","UbuntuMono-Bold.ttf");h(!0,!1,"Ubuntu Mono","UbuntuMono-Italic.ttf");h(!0,!0,"Ubuntu Mono","UbuntuMono-BoldItalic.ttf");h(!1,!1,"Vollkorn","Vollkorn-Regular.ttf");h(!1,!0,"Vollkorn","Vollkorn-Bold.ttf");h(!0,!1,"Vollkorn","Vollkorn-Regular.ttf");h(!0,!0,"Vollkorn","Vollkorn-Regular.ttf");
b.root=la(Wa);this.resize=function(a,c,d,e){p("ec:resize",[a,c,d,e]);b.box={left:a,top:c,width:d,height:e};X();b.view.rebuild()};this.init=function(a){b.primed=!1;b.tooltip=a.tooltip;b.inputBox=a.inputBox;b.context=a.context;b.storage=a.storage;b.translate=a.translate;b.imageBase=a.imageBase;b.panic=a.panic;b.warning=a.warning;b.status=a.status;b.saveUserSettings=a.saveUserSettings;b.clipboard=a.clipboard;b.loadFont=a.loadFont;b.findReferences=a.findReferences;b.openSub=a.openSub;b.root.innerHTML=
"";b.root.oncontextmenu=function(){return!1};a=m(b.root,"div");b.toolbar=a;var c=m(b.root,"canvas");c.oncontextmenu=function(){return!1};b.canvas=c;var d=m(b.root,"canvas");d.oncontextmenu=function(){return!1};b.over=d;c.style.position="absolute";c.style.background="cyan";d.style.position="absolute";d.style.display="none";d.style.pointerEvents="none";c=m(b.root,"div");b.back=c;HtmlUtils.setDivText(c,b.translate("BUT_EXIT_4WAY_SCROLL"));c.className="dlg_button common_button";c.style.position="absolute";
c.style.left="5px";c.style.top="5px";c.style.display="none";c.onclick=zc;c=m(b.root,"div");b.ro=c;HtmlUtils.setDivText(c,b.translate("MES_READONLY_DOC"));c.className="dlg_button";c.style.position="absolute";c.style.right="5px";c.style.top="5px";c.style.background="black";c.style.display="none";c.onclick=jc;a.className="toolbar";Ha(kc,"left","#F2F2F2","show-toobox.png");qc();b.dialogs={};B("dia-main");B("dia-free");B("dia-mind");B("dia-mind2");k("dia-main",[{id:"tt_theme",image:"theme.png",tooltip:"BUT_COLOR_THEME",
command:vc},{id:"tt_home",image:"home.png",tooltip:"BUT_HOME",command:J}]);k("dia-main",[{id:"tt_zoom",image:"zoom.png",tooltip:"BUT_ZOOM",command:wc},{id:"tt_4way",image:"4-way-pan.png",tooltip:"BUT_4WAY",command:Va}]);B("basic");B("medic");B("full");a={id:"tt_parameters",image:"params-1.png",tooltip:"BUT_PARAMETERS",command:function(){p("ec:addParameters");b.editor.addParameters();J()}};var c={id:"tt_comment",image:"comment.png",tooltip:"BUT_COMMENT",command:function(){q("comment")}},d={id:"tt_question",
image:"question.png",tooltip:"BUT_QUESTION",shortcut:"Q",command:function(){q("question")}},e={id:"tt_action",image:"action.png",tooltip:"BUT_ACTION",shortcut:"A",command:function(){q("action")}},f={id:"tt_branch",image:"branch.png",tooltip:"BUT_BRANCH",shortcut:"B",command:function(){q("branch")}},g={id:"tt_silhouette",image:"silhouette.png",tooltip:"BUT_SILHOUETTE",command:Ac},h={id:"tt_case",image:"case.png",tooltip:"BUT_CASE",shortcut:"C",command:function(){q("case")}},n={id:"tt_select",image:"select.png",
tooltip:"BUT_SELECT",shortcut:"S",command:function(){q("select")}},r={id:"tt_insertion",image:"insertion.png",tooltip:"BUT_INSERTION",shortcut:"N",command:function(){q("insertion")}},t={id:"tt_par",image:"par.png",tooltip:"BUT_PAR",command:function(){q("path")}},u={id:"tt_parblock",image:"parblock.png",tooltip:"BUT_PARBLOCK",command:function(){q("parallel")}},v={id:"tt_foreach",image:"foreach.png",tooltip:"BUT_FOREACH",shortcut:"L",command:function(){q("foreach")}},w={id:"tt_shelf",image:"shelf.png",
shortcut:"F",tooltip:"BUT_SHELF",command:function(){q("shelf")}},x={id:"tt_ctrl_start",image:"ctrl-start.png",tooltip:"BUT_CTRL_START",command:function(){q("ctrlStart")}},y={id:"tt_ctrl_end",image:"ctrl-end.png",tooltip:"BUT_CTRL_END",command:function(){q("ctrlEnd")}},z={id:"tt_duration",image:"duration.png",tooltip:"BUT_DURATION",command:function(){q("duration")}},A={id:"tt_pause",image:"pause.png",tooltip:"BUT_PAUSE",command:function(){q("pause")}},C={id:"tf_gdur_left",image:"group-duration.png",
tooltip:"BUT_GROUP_DURATION_LEFT",command:function(a){l(a,"gdur-left")}},E={id:"tf_gdur_right",image:"group-duration-r.png",tooltip:"BUT_GROUP_DURATION_RIGHT",command:function(a){l(a,"gdur-right")}},D={id:"callout",image:"callout.png",tooltip:"BUT_CALLOUT",command:function(a){l(a,"callout")}};k("full",[f,g]);k("full",[d,e]);k("full",[h,n]);k("full",[a,v]);k("full",[c,D]);k("full",[t,u]);k("full",[{id:"tt_input",image:"input.png",tooltip:"BUT_INPUT",command:function(){q("input")}},{id:"tt_output",
image:"output.png",tooltip:"BUT_OUTPUT",command:function(){q("output")}}]);k("full",[{id:"tt_sinput",image:"sinput.png",tooltip:"BUT_SINPUT",command:function(){q("sinput")}},{id:"tt_soutput",image:"soutput.png",tooltip:"BUT_SOUTPUT",command:function(){q("soutput")}}]);k("full",[{id:"tt_process",image:"process.png",tooltip:"BUT_PROCESS",command:function(){q("process")}},w]);k("full",[x,y]);k("full",[A,{id:"tt_timer",image:"timer.png",tooltip:"BUT_TIMER",command:function(){q("timer")}}]);k("full",[z,
r]);k("full",[C,E]);k("medic",[f,g]);k("medic",[d,e]);k("medic",[h,n]);k("medic",[c,D]);k("medic",[t,u]);k("medic",[x,y]);k("medic",[A,z]);k("medic",[C,E]);k("medic",[w,r]);k("basic",[f,g]);k("basic",[d,e]);k("basic",[h,n]);k("basic",[a,v]);k("basic",[c,D]);k("basic",[r]);B("free-basic");B("free-ui");B("free-ar");eb();fb();N()};this.loadSave=function(a){var c=function(){};a&&(c=lc);a=b.editor.diagramToJson();var d=b.translate("MES_DIAGRAM_SOURCE");b.inputBox.show(d,a,c,Nb)};this.undo=function(){b.readonly||
(p("ec:undo"),b.editor.performUndo(),b.view.redraw())};this.redo=function(){b.readonly||(p("ec:redo"),b.editor.performRedo(),b.view.redraw())};this.setDiagram=function(a,c){p("ec:setDiagram",[c]);w();var d=b.editor,e=b.view,f;b.name=a.name;b.type=a.type;b.background=a.background||"";b.diaLine=a.diaLine||"";b.diaLineThickness=a.diaLineThickness;b.tag=a.tag;b.freeScroll=!1;pa();ba();(f=na(a))?d.loadDiagram(f):d.createDiagram(a.name,a.type);c&&!b.readonly?(p("ec:autoResize"),b.delay=!0,b.editor.autoSizeIcons(),
b.delay=!1,sa()):d.buildTextBoxes();ba();d.redraw();d.clearUndo();e.rebuild();b.beh.resetMachines();CallTrace.reset()};this.setUserSettings=function(a){a.zoom&&b.view.zoomTo(a.zoom);a.theme&&(Theme.current=a.theme);a.toolbar&&Ta(a.toolbar);a.toolbarFree&&(b.toolNameFree=a.toolbarFree,N());b.editor.setUserSettings(a);b.items.setUserSettings(a);b.userColors=[];v(a,"colors",b,"userColors");v(a,"shape",b,"userShape");v(a,"font",b,"userFont");v(a,"background",b,"userBackground");v(a,"diaLine",b,"userDiaLine");
v(a,"diaLineThickness",b,"userDiaLineThickness")};this.home=J;this.setReadonly=function(a,c){b.readonly=a;b.editor.setReadonly(a);b.onReadonly=a?c:null};this.getTag=function(){return b.tag};this.renameDiagram=function(a,c){p("ec:renameDiagram",[c]);var d=new ItemsModule(b.translate),e=new Ya(a.name,a.background,a.diaLine,a.diaLineThickness,a.tag),f=new Canvas(C,y),d=new Editor(f,e,d,b.translate),f=va(a);d.loadDiagram(f);d.buildTextBoxes();d.renameDiagram(c);return e.change};this.getName=function(){return b.editor.storage.name};
this.deleteSelection=function(){p("ec:deleteSelection");b.editor.deleteSelection();b.view.redraw()};this.exportPng=function(a,c){var d=b.editor.measureDiagram(),e=Math.floor((d.right-d.left)*c),f=Math.floor((d.bottom-d.top)*c);a.style.left="0px";a.style.top="0px";a.style.display="inline-block";a.style.width=e+"px";a.style.height=f+"px";a.width=e;a.height=f;var g=a.getContext("2d");g.fillStyle=La();g.fillRect(0,0,e,f);g.scale(c,c);g.translate(-d.left,-d.top);var e=b.cnv.zoom,f=b.cnv.dx,h=b.cnv.dy,
k=b.cnv.retina;b.cnv.setTransform(-d.left,-d.top,c,1);b.editor.redraw();b.cnv.draw(g);b.cnv.setTransform(f,h,e,k);b.editor.redraw();b.view.rebuild();return a.toDataURL("image/png")};this.exportSvg=function(){var a=b.editor,c=b.cnv,d=a.measureDiagram(),e=Math.floor(1*(d.right-d.left)),f=Math.floor(1*(d.bottom-d.top)),g=new C2S(e,f);g.fillStyle=La();g.fillRect(0,0,e,f);g.scale(1,1);g.translate(-d.left,-d.top);c.renderToTexture=!1;a.redraw();c.draw(g);c.renderToTexture=!0;a.redraw();return g.getSerializedSvg(!0)};
this.getDiagram=function(){var a=b.editor.diagramToJson();return JSON.parse(a)};this.setToolName=Ta;this.getFonts=Na;this.showSockets=q;this.copy=function(){p("ec:copy");b.editor.copy();b.view.redraw()};this.cut=function(){p("ec:cut");b.editor.cut();b.view.redraw()};this.paste=function(){p("ec:paste");var a=b.view,c=b.canvas;a.getZoom();var d=c.getBoundingClientRect(),c=Math.round((d.left+d.right)/2),d=Math.round((d.top+d.bottom)/2),a=a.clientToDiagram(c,d);b.editor.paste(a.x,a.y);b.view.redraw()};
this.hideDialog=w;this.selectAll=function(){b.editor.selectAll();b.view.redraw()};this.getFontsFromEditor=function(){var a=b.editor.getDiagramAsItems();return Na(a)};this.isDrakon=wa;this.startEdit=function(){b.editor.startEdit()};this.arrowUp=function(a,c,d){p("ec:up");d?aa(0,-1):(d=b.view.getVisibleBox(),b.editor.arrowUp(a,c,d),b.view.redraw())};this.arrowDown=function(a,c,d){p("ec:down");d?aa(0,1):(d=b.view.getVisibleBox(),b.editor.arrowDown(a,c,d),b.view.redraw())};this.arrowLeft=function(a,c,
d){p("ec:left");d?aa(-1,0):(d=b.view.getVisibleBox(),b.editor.arrowLeft(a,c,d),b.view.redraw())};this.arrowRight=function(a,c,d){p("ec:right");d?aa(1,0):(d=b.view.getVisibleBox(),b.editor.arrowRight(a,c,d),b.view.redraw())};this.createLeftButton=Ha;this.showLeftButton=function(a){b.leftButts[a].visible=!0};this.hideLeftButton=function(a){b.leftButts[a].visible=!1};this.createRightButton=function(a,c,d){var e=b.rightButts.length;a={command:a,side:"right",direction:c,background:d};a={div:Ia(a),visible:!0,
button:a};b.rightButts.push(a);return e};this.showRightButton=function(a){b.rightButts[a].visible=!0};this.hideRightButton=function(a){b.rightButts[a].visible=!1};this.isDragOn=function(){return b.editor.dragOn||b.freeScroll?!0:!1};this.centerItem=function(a){if(a){var c=b.editor,d=c.getItem(a);if(d){var e=b.box.width;b.showToolbar&&(e-=115);var f=b.view.getZoom();b.view.pan(-d.x+e/2/f,-d.y+b.box.height/2/f);c.selectOneItem(a)}}};this.startPan=function(){b.freeScroll||b.beh.startFreeScroll()};this.endPan=
function(){b.freeScroll||b.beh.endFreeScroll()};this.resetMode=function(){b.freeScroll=!1};this.startFreeScroll=Va};
